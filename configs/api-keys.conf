# SOC Platform API Keys Configuration
# Centralized API key management with role-based access

# WARNING: Change all default keys before production deployment!
# These are example keys - generate new ones using ./scripts/generate-api-keys.sh

# Internal Service API Keys
[internal_services]

# Elasticsearch API Key for internal services
elasticsearch_api_key = "VnVhQ2ZHY0JDZGJrUW0tZTVhT3g6dWkybHAyYXhUTm1zeWFrdzl0dk5udw=="
elasticsearch_api_id = "elasticsearch-internal"
elasticsearch_permissions = ["read", "write", "monitor"]

# Kibana API Key for service communication
kibana_api_key = "M2Q4ZjU2YTMtNzc5Yy00YmE4LWIwOTYtODE2OWM5ZTc4YzE3"
kibana_api_id = "kibana-service"
kibana_permissions = ["dashboard", "visualize", "search"]

# Wazuh API Key for agent communication
wazuh_api_key = "N2Y1ZGIzYzYtNmJhOS00MmE4LWEwMzUtNzg5YWQ0ZTc5NjEx"
wazuh_api_id = "wazuh-agents"
wazuh_permissions = ["agent_read", "agent_write", "rules_read"]

# Cortex API Key for SOAR integration
cortex_api_key = "OGE3YjJkZTYtM2JjNy00YWQ5LWI2OTctMjE4NzQ5YzNmODE0"
cortex_api_id = "cortex-analyzer"
cortex_permissions = ["analyze", "read_jobs"]

# AI Engine API Key
ai_engine_api_key = "YTIzNGZkYzMtNDU2Ny00ODkwLWFiY2QtZWYxMjM0NTY3ODkw"
ai_engine_api_id = "ai-analyzer"
ai_engine_permissions = ["analyze", "model_access"]

# External Integration API Keys
[external_integrations]

# VirusTotal API Key
virustotal_api_key = "your_virustotal_api_key_here"
virustotal_rate_limit = 4  # requests per minute for free tier
virustotal_enabled = false

# Shodan API Key
shodan_api_key = "your_shodan_api_key_here"
shodan_rate_limit = 100  # requests per month for free tier
shodan_enabled = false

# AbuseIPDB API Key
abuseipdb_api_key = "your_abuseipdb_api_key_here"
abuseipdb_rate_limit = 1000  # requests per day for free tier
abuseipdb_enabled = false

# AlienVault OTX API Key
otx_api_key = "your_otx_api_key_here"
otx_enabled = false

# IBM X-Force API
xforce_api_key = "your_xforce_api_key_here"
xforce_api_password = "your_xforce_password_here"
xforce_enabled = false

# Hybrid Analysis API Key
hybrid_analysis_api_key = "your_hybrid_analysis_api_key_here"
hybrid_analysis_enabled = false

# MISP Integration
misp_api_key = "your_misp_api_key_here"
misp_url = "https://misp.company.com"
misp_verifycert = true
misp_enabled = false

# Threat Intelligence Feeds
[threat_feeds]

# Commercial Feeds
commercial_feed_1_key = "your_commercial_feed_key_here"
commercial_feed_1_url = "https://api.threatfeed.com/v1"
commercial_feed_1_enabled = false

# Open Source Intelligence Feeds
osint_feeds = [
    "https://rules.emergingthreats.net/open/suricata/rules/emerging-compromised.rules",
    "https://www.malwaredomainlist.com/hostslist/hosts.txt",
    "https://feodotracker.abuse.ch/downloads/ipblocklist.csv"
]

# Cloud Provider API Keys
[cloud_providers]

# AWS Security Integration
aws_access_key_id = "AKIA..."
aws_secret_access_key = "your_aws_secret_key_here"
aws_region = "us-east-1"
aws_enabled = false

# Azure Security Center Integration
azure_tenant_id = "your_azure_tenant_id_here"
azure_client_id = "your_azure_client_id_here"
azure_client_secret = "your_azure_client_secret_here"
azure_enabled = false

# Google Cloud Security Integration
gcp_project_id = "your_gcp_project_id_here"
gcp_service_account_key = "/path/to/service-account-key.json"
gcp_enabled = false

# Notification API Keys
[notifications]

# Slack Integration
slack_bot_token = "xoxb-your-slack-bot-token-here"
slack_channel = "#security-alerts"
slack_enabled = false

# Microsoft Teams Integration
teams_webhook_url = "https://company.webhook.office.com/webhookb2/..."
teams_enabled = false

# Email Integration (SMTP)
smtp_server = "smtp.company.com"
smtp_port = 587
smtp_username = "alerts@company.com"
smtp_password = "your_smtp_password_here"
smtp_use_tls = true
smtp_enabled = true

# PagerDuty Integration
pagerduty_integration_key = "your_pagerduty_integration_key_here"
pagerduty_enabled = false

# Twilio SMS Integration
twilio_account_sid = "your_twilio_account_sid_here"
twilio_auth_token = "your_twilio_auth_token_here"
twilio_from_number = "+1234567890"
twilio_enabled = false

# Webhook Endpoints
[webhooks]

# Custom Security Tools Integration
securitytool_webhook_url = "https://api.company.com/security/webhook"
securitytool_webhook_secret = "your_webhook_secret_here"
securitytool_webhook_enabled = false

# SIEM Integration Webhook
siem_webhook_url = "https://siem.company.com/api/alerts"
siem_webhook_token = "Bearer your_siem_token_here"
siem_webhook_enabled = false

# API Key Security Settings
[security_settings]

# Key Rotation Policy
key_rotation_days = 90
automatic_rotation = true
notify_before_expiry_days = 7

# Rate Limiting
default_rate_limit = 1000  # requests per hour
strict_rate_limit = 100   # requests per hour for external APIs

# API Security Headers
require_https = true
api_version = "v1"
max_request_size = "10MB"

# Allowed IP Ranges (CIDR notation)
allowed_ip_ranges = [
    "10.0.0.0/8",      # Internal network
    "172.16.0.0/12",   # Docker networks
    "192.168.0.0/16"   # Local networks
]

# API Monitoring
enable_api_logging = true
log_failed_requests = true
log_slow_requests = true
slow_request_threshold_ms = 5000

# Authentication Methods
[authentication]

# JWT Settings
jwt_secret_key = "your_jwt_secret_key_32_chars_minimum"
jwt_algorithm = "HS256"
jwt_expiration_hours = 24
jwt_refresh_enabled = true

# OAuth2 Settings
oauth2_client_id = "your_oauth2_client_id"
oauth2_client_secret = "your_oauth2_client_secret"
oauth2_redirect_uri = "https://soc.company.com/oauth/callback"
oauth2_enabled = false

# API Key Validation Settings
api_key_header = "X-API-Key"
api_key_query_param = "api_key"
require_api_key_for_endpoints = ["/api/v1/alerts", "/api/v1/incidents", "/api/v1/threats"]

# Backup and Recovery
[backup]

# Encrypted backup of API keys
backup_encryption_key = "your_32_char_backup_encryption_key"
backup_location = "/secure/backups/api-keys"
backup_schedule = "daily"
backup_retention_days = 30

# Key escrow for disaster recovery
key_escrow_enabled = true
key_escrow_location = "/secure/escrow"
key_escrow_encryption = "AES-256-GCM"

# Audit Trail
[audit]

# Log all API key usage
enable_api_key_audit = true
audit_log_location = "/var/log/soc-platform/api-audit.log"
audit_log_format = "json"
audit_log_retention_days = 365

# Alert on suspicious API usage
suspicious_usage_alert = true
suspicious_patterns = [
    "rapid_sequential_requests",
    "unusual_ip_addresses",
    "failed_authentication_attempts",
    "privilege_escalation_attempts"
]

# Integration Test Endpoints
[testing]

# Sandbox API keys for testing (limited permissions)
sandbox_elasticsearch_key = "test_elasticsearch_key_limited_scope"
sandbox_kibana_key = "test_kibana_key_read_only"
sandbox_wazuh_key = "test_wazuh_key_limited_agents"

# Test environment settings
test_environment_enabled = false
test_data_retention_hours = 24
test_rate_limit_multiplier = 0.1
