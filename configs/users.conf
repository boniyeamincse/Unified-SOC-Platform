# SOC Platform User Management Configuration
# Role-Based Access Control (RBAC) for security

# Default Admin User (Change password immediately!)
[admin]
username = admin
password_hash = $2b$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewHgpQZs5XF8pWou  # changeme123
roles = soc_admin, kibana_admin, wazuh_admin
email = admin@company.com
mfa_enabled = true
last_login = never
account_locked = false
password_expires = 90
session_timeout = 3600

# SOC Analyst Level 1
[analyst1]
username = analyst1
password_hash = $2b$12$8B2y9YlYZWJQRH3Zx/mFve7vR5LQo6S9YkjG7eFVbN4M8pL3qW2s6  # analyst123
roles = soc_analyst_l1, kibana_read
email = analyst1@company.com
mfa_enabled = true
last_login = never
account_locked = false
password_expires = 90
session_timeout = 1800
max_concurrent_sessions = 2

# SOC Analyst Level 2
[analyst2]
username = analyst2
password_hash = $2b$12$9C3zA2mZ6WKRSq4Ay/nGwf8wS6MRp7T0ZlkH8gGWcO5N9qM4rX3t7  # analyst2sec
roles = soc_analyst_l2, kibana_write, wazuh_read
email = analyst2@company.com
mfa_enabled = true
last_login = never
account_locked = false
password_expires = 90
session_timeout = 3600
max_concurrent_sessions = 3

# Security Engineer
[seceng]
username = security_engineer
password_hash = $2b$12$4D5eB3n4N7LTUC5By/oHxg9xT7NSq8U1AmkI9hHXdP6O0rN5sY4u8  # seceng456
roles = soc_engineer, kibana_admin, wazuh_write, cortex_admin
email = seceng@company.com
mfa_enabled = true
last_login = never
account_locked = false
password_expires = 60
session_timeout = 7200
max_concurrent_sessions = 5

# Threat Hunter
[hunter]
username = threat_hunter
password_hash = $2b$12$6F7gC5o6O9MWUD7Cy/qIyh1yU9OTr0V2BnlJ0iIYeQ8P2sO6tZ6v0  # hunter789
roles = threat_hunter, kibana_admin, misp_read, cortex_read
email = hunter@company.com
mfa_enabled = true
last_login = never
account_locked = false
password_expires = 60
session_timeout = 3600
max_concurrent_sessions = 3

# Read-Only Auditor
[auditor]
username = auditor
password_hash = $2b$12$8H9iD7p8P0NXVF9Dz/rJzi2zV0PUr2W3ColK1jJZfR0Q4tP8u[7w2  # audit2025
roles = auditor_readonly
email = auditor@company.com
mfa_enabled = true
last_login = never
account_locked = false
password_expires = 120
session_timeout = 1800
max_concurrent_sessions = 2

# Service Account for API Access
[api_service]
username = api_service
password_hash = $2b$12$0I1jE9q9Q2OYWG0Ez/sKzj3zA2QVs4X4DpmL2kKagS2R6uQ0v89x4  # service999
roles = api_access
email = api@company.com
mfa_enabled = false
last_login = never
account_locked = false
password_expires = 30
session_timeout = 3600
max_concurrent_sessions = 10
account_type = service

# Guest/Demo Account (Limited Access)
[demo]
username = demo
password_hash = $2b$12$2J3kF0r0R4PZYH2F0/tL0k4zB4RWt6Y5EqnM3lLbhT4S8vR2w01y6  # demo123
roles = demo_access
email = demo@company.com
mfa_enabled = false
last_login = never
account_locked = false
password_expires = 7
session_timeout = 900
max_concurrent_sessions = 1
account_expires = 2025-12-31

# Role Definitions
[roles]

# Super Admin - Full access to everything
soc_admin = {
    "elasticsearch": ["all"],
    "kibana": ["all"],
    "wazuh": ["all"],
    "cortex": ["all"],
    "misp": ["all"],
    "system": ["admin"],
    "users": ["manage"],
    "config": ["write"]
}

# Level 1 Analyst - Basic monitoring and investigation
soc_analyst_l1 = {
    "elasticsearch": ["read", "search"],
    "kibana": ["read", "visualize"],
    "wazuh": ["read", "alerts"],
    "cortex": ["read"],
    "misp": ["read"],
    "dashboards": ["view"]
}

# Level 2 Analyst - Enhanced investigation capabilities
soc_analyst_l2 = {
    "elasticsearch": ["read", "search", "index_basic"],
    "kibana": ["read", "write", "visualize", "dashboard_edit"],
    "wazuh": ["read", "write", "rules_basic"],
    "cortex": ["read", "analyze"],
    "misp": ["read", "contribute"],
    "cases": ["create", "update"]
}

# Security Engineer - System configuration and advanced analysis
soc_engineer = {
    "elasticsearch": ["read", "write", "admin"],
    "kibana": ["all"],
    "wazuh": ["read", "write", "rules_advanced", "config"],
    "cortex": ["all"],
    "misp": ["read", "write", "admin"],
    "system": ["config"],
    "integrations": ["manage"]
}

# Threat Hunter - Advanced hunting and analysis
threat_hunter = {
    "elasticsearch": ["read", "search", "advanced_query"],
    "kibana": ["read", "write", "advanced_visualize"],
    "wazuh": ["read", "hunt"],
    "cortex": ["read", "analyze"],
    "misp": ["read", "hunt"],
    "threat_intel": ["all"],
    "hunting_queries": ["create", "share"]
}

# Auditor - Read-only access for compliance
auditor_readonly = {
    "elasticsearch": ["read"],
    "kibana": ["read"],
    "wazuh": ["read"],
    "cortex": ["read"],
    "misp": ["read"],
    "audit_logs": ["read"],
    "reports": ["view"]
}

# API Service Account - Programmatic access
api_access = {
    "elasticsearch": ["read", "write"],
    "wazuh": ["read", "write"],
    "api": ["read", "write"],
    "webhooks": ["send"]
}

# Demo Account - Limited demo access
demo_access = {
    "kibana": ["read"],
    "dashboards": ["view"],
    "demo_data": ["read"]
}

# Security Policies
[security_policies]
password_policy = {
    "min_length": 12,
    "require_uppercase": true,
    "require_lowercase": true,
    "require_numbers": true,
    "require_special_chars": true,
    "no_common_passwords": true,
    "no_username_in_password": true,
    "password_history": 5
}

session_policy = {
    "max_idle_time": 1800,
    "absolute_timeout": 28800,
    "concurrent_session_limit": 5,
    "secure_cookies": true,
    "httponly_cookies": true,
    "samesite_cookies": "strict"
}

account_lockout = {
    "failed_attempts_threshold": 5,
    "lockout_duration": 900,
    "auto_unlock": true,
    "admin_notification": true
}

mfa_policy = {
    "required_roles": ["soc_admin", "soc_engineer"],
    "methods": ["totp", "sms", "email"],
    "backup_codes": 10,
    "remember_device_days": 30
}

# Audit Configuration
[audit]
enable_user_activity_logging = true
enable_privilege_escalation_alerts = true
enable_failed_login_alerts = true
log_retention_days = 365
log_level = "INFO"

# Integration Settings
[ldap_integration]
enabled = false
server = "ldap://company.com:389"
bind_dn = "cn=admin,dc=company,dc=com"
user_search_base = "ou=users,dc=company,dc=com"
group_search_base = "ou=groups,dc=company,dc=com"
ssl_enabled = true
cert_validation = true

# SSO Integration (SAML)
[saml_integration]
enabled = false
idp_metadata_url = "https://company.com/saml/metadata"
sp_entity_id = "soc-platform"
attribute_mapping = {
    "email": "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress",
    "name": "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name",
    "groups": "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/groups"
}
